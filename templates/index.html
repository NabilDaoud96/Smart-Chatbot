<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <title>DB ChatBot Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-lg p-6 space-y-6">
      <!-- Kopfzeile mit Icon -->
      <div class="flex items-center justify-center space-x-3">
        <!-- Heroicon: Academic Cap -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-8 w-8 text-blue-600"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 14l9-5-9-5-9 5 9 5z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 14l6.16-3.422a12.083 12.083 0 01.84 4.932c0 1.318-.05 2.638-.15 3.95M12 14v7m0 0H6m6 0h6"
          />
        </svg>
        <h1 class="text-3xl font-bold text-blue-700">DB-ChatBot Assistant</h1>
      </div>

      <!-- Formular mit Dropdown und Eingabefeld -->
      <form method="POST" action="/" class="space-y-4">
        <!-- Dropdown: Datenbankauswahl -->
        <label for="db_typ" class="block text-gray-700 font-semibold">
          Welche Datenbank?
        </label>
        <select
          name="db_typ"
          id="db_typ"
          class="w-full p-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
          required
        >
          <option value="">wählen Sie eine Datenbank aus</option>
          <option value="sqlite">Hochschule (SQLite)</option>
          <option value="mysql">Einkaufssystem (MySQL)</option>
          <option value="postgresql">Finanzdaten (PostgreSQL)</option>
        </select>

        <!-- Eingabefeld -->
        <label for="frage" class="block text-gray-700 font-semibold">
          Deine Frage:
        </label>
        <input
          type="text"
          name="frage"
          id="frage"
          class="w-full p-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Frag mich etwas zur Datenbank..."
          autocomplete="off"
          required
        />

        <!-- Abschicken-Button -->
        <div class="text-center">
          <button
            type="submit"
            class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition"
          >
            Abschicken
          </button>
        </div>
      </form>

      <!-- Ausgabe: SQL-Abfrage -->
      {% if sql_query %}
      <div>
        <div class="flex items-center space-x-2 text-blue-700 mb-1">
          <!-- Icon -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 text-blue-700"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 18l6-6-6-6M8 6l-6 6 6 6"
            />
          </svg>
          <h3 class="text-lg font-semibold">Generierte SQL-Abfrage:</h3>
        </div>
        <pre
          class="bg-gray-100 p-3 rounded-md text-sm text-gray-800 overflow-x-auto"
        >
            {{ sql_query }}
          </pre
        >
      </div>
      {% endif %}

      <!-- Ausgabe: Antwort-Tabelle -->
      {% if antwort %} {% if antwort|length > 1 %}
      <!-- Tabelle mit Ergebnissen -->
      <div>
        <div class="flex items-center space-x-2 text-green-700 mb-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 text-green-700"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 10h16M4 14h16M4 18h16"
            />
          </svg>
          <h3 class="text-lg font-semibold">Antwort:</h3>
        </div>
        <div class="overflow-x-auto">
          <table
            class="min-w-full border border-gray-300 rounded-md overflow-hidden"
          >
            <thead class="bg-blue-100 text-blue-900 text-left">
              <tr>
                {% for eintrag in antwort[0] %}
                <th class="px-4 py-2 font-medium border-b">{{ eintrag }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody class="bg-white text-gray-800">
              {% for zeile in antwort[1:] %}
              <tr class="border-t hover:bg-gray-50">
                {% for eintrag in zeile %}
                <td class="px-4 py-2 border-b">{{ eintrag }}</td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      {% else %}
      <!-- Leere oder ungültige Antwort -->
      <div class="text-red-600 bg-red-100 p-4 rounded-lg border border-red-300">
        <p>
          <strong>Hinweis:</strong> Keine Daten gefunden oder die Anfrage passt
          nicht zu dieser Datenbank.<br />Bitte stellen Sie eine andere Frage
          oder prüfen Sie den Zusammenhang.
        </p>
      </div>
      {% endif %} {% endif %}
    </div>
  </body>
</html>
